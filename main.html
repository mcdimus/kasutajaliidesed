<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />

        <title>Kasutajaliidesed</title>

        <script type="text/javascript" src="http://code.jquery.com/jquery-1.7.2.js"> </script>
        <script type="text/javascript" src="http://cloud.github.com/downloads/SteveSanderson/knockout/knockout-2.0.0.debug.js"> </script>
        <link rel="stylesheet" href="css/style.css"/>
    </head>
    <body>
        <div id="main-wrapper">
            <div id="header-wrapper">
                <div id="logo">
                    <a href="index.html" title="TODO">
                        <img src="img/logo.png" alt="TODO"/>
                    </a>
                </div>
                <div class="sign-out">
                    <form id="signout-form" action="#" method="post">
                        <div class="signout-div">
                            <span id="login-span">
                                User:
                                <strong class="login-label">Username</strong>
                            </span>
                            <input type="hidden" spellcheck="false" name="login" value=""/>
                        </div>
                        <input type="submit" class="g-button g-button-submit" name="signOut" id="signOut" value="Sign out"/>
                    </form>
                </div>
            </div>
            <!--end header-wrapper-->

            <div id="content-wrapper">
                <div class="tag-container" >
                    <h3>Tags</h3>
                    <ul data-bind="foreach: tags">
                        <li>
                            <input type="checkbox" data-bind="checked: isChecked" />
                            <span data-bind="text: name"></span>
                        </li>
                    </ul>
                    <button data-bind="click: deleteTags" id="deleteTags" class="g-button" name="deleteTags">Delete checked</button>
                    <input type="text" id="newtag" name="newtag" class="tag-area-inputs" placeholder="New tag name..." />
                    <button data-bind="click: addTag" id="addtag" class="g-button g-button-submit" name="addtag">Add</button>
                </div>

                <div class="main">
                    <div class="todo" id="new-todo">
                        <h3 class="todo-heading">New TODO</h3>
                        <input type="checkbox" name="todo-urgent">urgent</input>
                        <input type="checkbox" name="todo-important">important</input>
                        <div id="todo-for-tags"><span>tags: </span></div>
                        <input type="text" name="todo-name" placeholder="TODO name here ..."/>
                        <input type="text" name="todo-date" placeholder="TODO date here ..."/>
                        <textarea name="todo-text" placeholder="TODO text here ..."></textarea>
                        <button name="todo-submit" class="g-button g-button-submit" onclick="somefunc();">Submit</button>
                    </div>
                    <button name="todo-add" id="todo-add" class="g-button g-button-submit" onclick="showHide()">Add TODO</button>
                    <div class="todo">
                        <h3 class="todo-heading">TODO #1</h2>
                    </div>
                    <div class="todo">
                        <h3 class="todo-heading">TODO #2</h2>
                    </div>
                </div>
                    <script type="text/javascript" >

                        function somefunc() {
                            //TODO tag addenum to the new TODO on checkbox check

                            // var smth = $('div.class-container input[type="checkbox"]').isChecked;
                            // alert(smth);
                        }

                        function showHide() {
                            var newTodoDiv = $('div#new-todo');
                            var buttonTodoAdd = $('button#todo-add');
                            if (buttonTodoAdd.text() == "Add TODO") {
                                $(newTodoDiv).css('display', 'block');
                                $(buttonTodoAdd).text('Cancel');
                            } else {
                                $(newTodoDiv).css('display', 'none');
                                $(buttonTodoAdd).text('Add TODO');
                            }
                        }

                        
                        function Tag(name, checked) {
                            return {
                                name : ko.observable(name),
                                isChecked : ko.observable(checked)
                            };
                        }

                        function TagsViewModel() {
                            var self = this;

                            self.tags =
                                ko.observableArray([
                                new Tag("school",false),
                                new Tag("birthday",false),
                                new Tag("meeting",false),
                                new Tag("work",false)
                            ]);

                            self.addTag = function () {
                                var newTag = $('input[name=newtag]').val();
                                if (newTag != '')
                                    self.tags.push(new Tag(newTag, false));
                            };
                            self.deleteTags = function() {
                                var selectedTags = $.grep(self.tags(), function(tag) {

                                    return (tag.isChecked());
                                });
                                $(selectedTags).each( function(index, tag) {
                                    self.tags.remove(tag);
                                });
                                // TODO delete KO? ja po4inil JQuery, t. k. 4erez KO v IE ne rabotalo.
                                
                                // ko.utils.arrayForEach(selectedTags, function(tag) {
                                //     self.tags.remove(tag);
                                // });
                            };
                        }

                        ko.applyBindings(new TagsViewModel());

                    </script>
            </div>
            <!--end content-wrapper-->
            <div id="footer-wrapper">
                <ul id="footer-container-right">
                    <li id="copyright">
                        Copyright © 2012
                        <a href="" title="// TODO:">// TODO:</a>
                        . All Rights Reserved
                    </li>
                    <!--end copyright-->
                    <li id="designed">
                        Designed by Dmitri Maksimov
                    </li>
                    <!--end designed -->
                </ul>
            </div>
            <!--end footer-wrapper-->
        </div>
        <!--end main wrapper-->
    </body>
</html>